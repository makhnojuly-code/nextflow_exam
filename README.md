HDV Genome Alignment Pipeline (Nextflow Project)

This project implements a Nextflow pipeline for the analysis of Hepatitis delta virus (HDV) genomes. In a research group working with HDV, complete viral genomes are received from a sequencing laboratory. Colleagues need to compare these genomes with a reference genome from GenBank to monitor genetic differences. Since individual analyses are not part of the sequencing service, this automated and reproducible pipeline was created to replicate the agreed workflow.

Goal

The aim of this pipeline is to:

Align all sample genomes to a reference genome

Clean the resulting alignment by removing low-quality positions

Produce a simple visualization of the final alignment

All steps are executed automatically and reproducibly using Singularity containers.

Workflow Overview

The pipeline consists of four main steps:

Download Reference Genome
The reference genome is downloaded from NCBI using its accession number (default: M21012).

Combine FASTA Files
The reference genome is combined with a set of viral genomes obtained from sequencing into one unified FASTA file.

Alignment (MAFFT)
The combined FASTA file is aligned using the MAFFT program.

Cleanup and Visualization (TrimAl)
The resulting alignment is cleaned using TrimAl with the parameter -automated1, which was selected together with colleagues as the most suitable option. TrimAl also generates an HTML file for visual inspection of the alignment.

Execution

To run the analysis, navigate to the project directory and execute:

nextflow run main.nf -profile singularity


By default, the pipeline downloads the reference genome M21012 and uses the input file data/hepatitis_combined.fasta, which contains all the sample genomes.

After successful execution, the following output directories are created:

results/reference — downloaded reference genome

results/combined — merged FASTA file

results/align — alignment generated by MAFFT

results/final — final cleaned alignment and visualization files

The final output files of interest are:

alignment_trimmed.fasta — cleaned alignment

alignment_trimmed.html — HTML visualization of the alignment

Notes

Some preparatory steps (such as downloading example data and creating the folder structure) were performed manually before automating the process. After validation, the workflow can now be executed fully automatically using Nextflow.

